{"title":"微信小程序快速上手教程-3","date":"2019-07-29T05:45:00.000Z","date_formatted":{"ll":"Jul 29, 2019","L":"07/29/2019","MM-DD":"07-29"},"link":"/course-wechat-3","comments":true,"tags":["微信小程序"],"categories":["Learning"],"updated":"2021-02-27T13:49:35.662Z","content":"<p>  这一节我们将实现个人课程表小程序开发！<br>\n内容主要有：</p>\n<ul>\n<li>可滑动视图：scroll-view</li>\n<li>网络请求：wx.request</li>\n<li>滚动选择器：picker</li>\n<li>表单容器：form</li>\n<li>页面切换</li>\n</ul>\n <span id=\"more\"></span>\n<h1 id=\"教程（三）-个人课程表实现\">教程（三）-个人课程表实现<a title=\"#教程（三）-个人课程表实现\" href=\"#教程（三）-个人课程表实现\"></a></h1>\n<h2 id=\"一、本节简介\">一、本节简介<a title=\"#一、本节简介\" href=\"#一、本节简介\"></a></h2>\n<p>  上节内容主要讲解了微信小程序几个常用API和引用框架。我发现干讲知识有点太枯燥，这节开始实战- <strong>个人课程表</strong> ，在项目编写过程中，顺带讲知识点，先把本节知识点列出来，看完教程希望多阅读阅读官方文档。下面知识点均链接到具体官方文档地址。</p>\n<ul>\n<li>可滑动视图<a href=\"https://developers.weixin.qq.com/miniprogram/dev/component/scroll-view.html\" target=\"_blank\">scroll-view</a></li>\n<li>网络请求<a href=\"https://developers.weixin.qq.com/miniprogram/dev/api/network/request/wx.request.html\" target=\"_blank\">wx.request</a></li>\n<li>滚动选择器<a href=\"https://developers.weixin.qq.com/miniprogram/dev/component/picker.html\" target=\"_blank\">picker</a></li>\n<li>表单容器<a href=\"https://developers.weixin.qq.com/miniprogram/dev/component/form.html\" target=\"_blank\">form</a></li>\n</ul>\n<h2 id=\"二、先画课程表\">二、先画课程表<a title=\"#二、先画课程表\" href=\"#二、先画课程表\"></a></h2>\n<p>  我们直奔主题，先把课程表显示出来。在写之前，我们要先分析一下布局。想思考一下，我们的课程表横按周一至周日排列，纵按节次排列，那就是一个表格了，在微信小程序里，没有table，tr，td标签，我们可以通过flex布局自己来实现。<br>\n<img src=\"../images/20190729141315.jpg\" alt=\"image\"></p>\n<h3 id=\"2.1-先实现课程表布局\">2.1 先实现课程表布局<a title=\"#2.1-先实现课程表布局\" href=\"#2.1-先实现课程表布局\"></a></h3>\n<p><img src=\"../images/20190729142904.jpg\" alt=\"image\" class=\"φbs\"></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--index.wxml--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;app&#x27;</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;table&#x27;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;tr&#x27;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;tr&#x27;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>&gt;</span>我是高数<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**index.wxss**/</span></span><br><span class=\"line\"><span class=\"selector-class\">.app</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">8</span>rpx;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.table</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">  <span class=\"attribute\">flex-direction</span>: column;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.tr</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">  <span class=\"attribute\">flex-direction</span>: row;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.td</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: red;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">120</span>rpx;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">180</span>rpx;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">10</span>rpx;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">8</span>rpx;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">28</span>rpx;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>最外层加了.app的容器，一般建议做一个页面最外层都包裹起，在不清楚默认会是什么容器下，这种做法是最好的。然后让内边距距离边缘8rpx，为了让内容不是贴着边的，比较好看好看点。</li>\n<li>先前已经说了，微信小程序是没有表格标签的，我们通过flex布局自己实现了表格布局。最外层.table作为容器，让内部元素flex纵向排列，也就是让.tr容器纵向排列。</li>\n<li>然后.tr作为行容器，以flex布局，让内部.td横向排列。</li>\n<li>.td将作为我们课程表的每个课程的容器。开发时先设置了背景色便于我们观察。设置好宽高，设置margin是让各个.td之间隔开。padding同样是为了内部内容不贴边显得美观点。</li>\n<li>最后，我们可以将.tr复制成5行，就对应了1-2,3-4,5-6,7-8,9-10节课。好了，我们的布局大概这样实现了。还是挺容易地吧。之后我们就可以在.td里填入我们的课程信息了。</li>\n</ul>\n<h3 id=\"2.2-思考？列表渲染\">2.2 思考？列表渲染<a title=\"#2.2-思考？列表渲染\" href=\"#2.2-思考？列表渲染\"></a></h3>\n<p>  相信有人注意到了，我们前面其实很多重复代码，例如.tr行，.td单元格。而我们上一节刚刚将了列表渲染。那我们来思考一下，如何进行列表渲染。</p>\n<ul>\n<li>首先，.table是只有一个的，不用进行列表渲染；</li>\n<li>.tr行，这个我们需要5行（1-2，3-4，5-6，7-8，9-10）。<a href=\"http://xn--ciqp65eckn.xn--tr5-l68dj7m6s0iujj.td\">而没个.tr内还要5个.td</a>（暂不考虑周六周日课程）。那么我就需要一个二维数组格式的列表数据了。</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kcb: [</span><br><span class=\"line\">    [<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>],</span><br><span class=\"line\">    [<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>],</span><br><span class=\"line\">    [<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>],</span><br><span class=\"line\">    [<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>],</span><br><span class=\"line\">    [<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>,<span class=\"string\">&quot;我是高数&quot;</span>]</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<ul>\n<li>好像上面的数据格式已经可以满足我们的列表渲染了。但再仔细想想，我们的课程表好像还要显示其他的信息吧，教室？教师？等数据怎么安排？</li>\n<li>先看看如下格式：</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kcb: [</span><br><span class=\"line\">    [&#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;,</span><br><span class=\"line\">     &#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;,</span><br><span class=\"line\">     &#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;,</span><br><span class=\"line\">     &#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;,</span><br><span class=\"line\">     &#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;],</span><br><span class=\"line\"></span><br><span class=\"line\">    [&#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;,</span><br><span class=\"line\">     &#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;,</span><br><span class=\"line\">     &#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;,</span><br><span class=\"line\">     &#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;,</span><br><span class=\"line\">     &#123;<span class=\"attr\">name</span>: <span class=\"string\">&quot;我是高数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A233&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;教师名&quot;</span>&#125;],</span><br><span class=\"line\"></span><br><span class=\"line\">    [...],[...],[...] <span class=\"comment\">//篇幅有限，就不复制了吧</span></span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<ul>\n<li>对！对象！使用对象，我们可以将每一个.td内容存为一个对象，然后渲染数据的时候，我们可以通过item.name获取课程名，item.room获取教室。</li>\n</ul>\n<h3 id=\"2.3-列表渲染实现布局\">2.3 列表渲染实现布局<a title=\"#2.3-列表渲染实现布局\" href=\"#2.3-列表渲染实现布局\"></a></h3>\n<ul>\n<li>我们先将数据写进js中的data里，大家可以直接复制下面数据。数据就这样先用假的。</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js</span></span><br><span class=\"line\">Page(&#123;</span><br><span class=\"line\">  data: &#123;</span><br><span class=\"line\">    kcb: [</span><br><span class=\"line\">      [</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;高数1&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A231&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;吴老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;大学英语&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A512&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;刘老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;计算机基础&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;B322&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;王老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">      ],</span><br><span class=\"line\">      [</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;大学物理1&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A211&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;陈老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;体育&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;操场&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;赵老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;大学物理1&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A111&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;还老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;线性代数&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A432&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;姜老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;高数1&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A231&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;吴老师&quot;</span> &#125;,</span><br><span class=\"line\">      ],</span><br><span class=\"line\">      [</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;日语基础&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A152&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;忘老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;Java开发&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;B111&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;乐老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;大学英语&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A512&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;刘老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;计算机基础&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;B322&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;王老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">      ],</span><br><span class=\"line\">      [</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;高数1&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A231&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;吴老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;大学英语&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A512&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;刘老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;计算机基础&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;B322&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;王老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;高数1&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A231&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;吴老师&quot;</span> &#125;,</span><br><span class=\"line\">      ],</span><br><span class=\"line\">      [</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;大物1重修&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A123&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;好老师&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">        &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">      ],</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>列表渲染</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--index.wxml--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;app&#x27;</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;table&#x27;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;tr&#x27;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">wx:for</span>=<span class=\"string\">&quot;&#123;&#123;kcb&#125;&#125;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">wx:for-index</span>=<span class=\"string\">&quot;i&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">wx:for-item</span>=<span class=\"string\">&quot;trItem&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">wx:key</span>=<span class=\"string\">&quot;i&quot;</span> &gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;td&#x27;</span>  </span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">wx:for</span>=<span class=\"string\">&quot;&#123;&#123;trItem&#125;&#125;&quot;</span>   </span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">wx:for-index</span>=<span class=\"string\">&quot;j&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">wx:for-item</span>=<span class=\"string\">&quot;tdItem&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">wx:key</span>=<span class=\"string\">&quot;j&quot;</span> &gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">text</span>&gt;</span>&#123;&#123;tdItem.name&#125;&#125;\\n&#123;&#123;tdItem.teacher&#125;&#125;\\n&#123;&#123;tdItem.room&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">text</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>我们先来分析一下，数据格式前面已经分析了，这里用的假数据，课程表中没有课的，name，room，teacher当然也应该是空的“”。</li>\n<li>这里用的嵌套渲染，外层通过循环kcb数组，获取到每行trItem的子数组，子层通过循环子数组trItem，获取里面的每个对象tdItem。</li>\n<li>最后通过tdItem对象显示课程的课程表名，教室和教师信息。</li>\n<li>来看看效果：<br>\n<img src=\"../images/20190729154440.jpg\" alt=\"iamge\"></li>\n<li>布局就将到这了。</li>\n<li>这里留下一个思考：<strong>部分没有课的内容，如何让其不显示？且保证后面课程不向前串？</strong></li>\n<li>再根据以下提示，写出加上周六周日课程的可滑动视图：\n<ul>\n<li>数据：应该怎样添加？</li>\n<li>可滑动视图：参考一下官网文档</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">scroll-view</span> <span class=\"attr\">scroll-x</span>=<span class=\"string\">&quot;true&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;width: ?rpx;&quot;</span> &gt;</span></span><br><span class=\"line\">  可滑动内容</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">scroll-view</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"三、思考答案\">三、思考答案<a title=\"#三、思考答案\" href=\"#三、思考答案\"></a></h2>\n<ul>\n<li>1.通过wx-if判断tdItem.name是否为空，将背景颜色设置成白色。</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;view <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">&#x27;td&#x27;</span>  </span><br><span class=\"line\">      wx:<span class=\"keyword\">for</span>=<span class=\"string\">&quot;&#123;&#123;trItem&#125;&#125;&quot;</span>   </span><br><span class=\"line\">      wx:<span class=\"keyword\">for</span>-index=<span class=\"string\">&quot;j&quot;</span></span><br><span class=\"line\">      wx:<span class=\"keyword\">for</span>-item=<span class=\"string\">&quot;tdItem&quot;</span></span><br><span class=\"line\">      wx:key=<span class=\"string\">&quot;j&quot;</span></span><br><span class=\"line\">      style=<span class=\"string\">&#x27;background-color:&#123;&#123;tdItem.name==&quot;&quot;?&quot;white&quot;:&quot;red&quot;&#125;&#125;&#x27;</span></span><br><span class=\"line\">      &gt;</span><br><span class=\"line\">      &lt;text&gt;&#123;&#123;tdItem.name&#125;&#125;\\n&#123;&#123;tdItem.teacher&#125;&#125;\\n&#123;&#123;tdItem.room&#125;&#125;&lt;/text&gt;</span><br><span class=\"line\">&lt;/view&gt;</span><br></pre></td></tr></table></figure>\n<p>在｛｛｝｝里可以进行简单的逻辑判断计算，这里是通过三元运算计算出该显示的颜色。之后课程表根据课程不同显示不同颜色，会先进行数据处理，再这样设置颜色。这里暂时先理解理解如何控制样式。</p>\n<ul>\n<li>2.周六周日数据在每个子数组后面加两个对象，分别是周六和周日。</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[</span><br><span class=\"line\">  [</span><br><span class=\"line\">    &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;高数1&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A231&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;吴老师&quot;</span> &#125;,</span><br><span class=\"line\">    &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">    &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;大学英语&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;A512&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;刘老师&quot;</span> &#125;,</span><br><span class=\"line\">    &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;计算机基础&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;B322&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;王老师&quot;</span> &#125;,</span><br><span class=\"line\">    &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">    &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;周六的课&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;,</span><br><span class=\"line\">    &#123; <span class=\"attr\">name</span>: <span class=\"string\">&quot;周日的课&quot;</span>, <span class=\"attr\">room</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"attr\">teacher</span>: <span class=\"string\">&quot;&quot;</span> &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\"><span class=\"comment\">//以下省略</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>3.可滑动视图 width = 120x7 + 20x6 + 10x2 = 980rpx<br>\n一行7个课程：120x7，课程间距：20x6，左右边界：10x2。<br>\n可滑动视图可能在开发工具上体现不出效果，可以在手机上预览。<br>\n至于想要一屏幕显示5个课程，而周六那不冒出来，需要自己计算出每个课程的宽度，大概是128rpx。先不着急计算这个，之后还需要在课程表左侧加1-2，3-4的课程提示，上方还要加周次选择和头部周一至周日显示。</li>\n</ul>\n<h2 id=\"四、网络请求\">四、网络请求<a title=\"#四、网络请求\" href=\"#四、网络请求\"></a></h2>\n<p>  前面已经把如何显示写好了，但利用的假数据，这里我将提供给大家一个网络接口，大家通过这个接口节可以获取自己的课程表信息了。多说一句，其实开发过程就是这样的，前端人员先通过自己写假数据先用于写页面，最后再通过网络接口连接后台整合项目。这样假数据不依赖网络，既提高了前端开发的速度，也减少了服务器资源。</p>\n<ul>\n<li>接口说明：\n<ul>\n<li>\n<p>接口地址：<a href=\"https://server-1.isdz.cn/api/kcb.dev.php\">https://server-1.isdz.cn/api/kcb.dev.php</a></p>\n</li>\n<li>\n<p>传输方式：POST</p>\n</li>\n<li>\n<p>请求参数：见下方表格</p>\n</li>\n<li>\n<p>返回参数：<br>\n格式：JSON<br>\n失败返回：Object：{“state”:“error”}<br>\n成功返回：</p>\n<ul>\n<li>Array(6): [Array(7),Array(7),…]</li>\n<li>-内层：Array(7)=[Object,Object,…]</li>\n<li>-Object：{“name”: “课程名”,“room”:“教室”,“teacher”: “教师(职称)”,“index”: “”}</li>\n</ul>\n</li>\n<li>\n<p>解释说明：失败原因可能是学号密码等参数有错。成功返回的是一个二维数组，外层数组表示1-2，3-4，5-6，7-8，9-10，11-12节课，内层数组表示周一至周日，例 <code>obj = array[0][1] 表示第1-2节课中周二的课程信息</code>，最后通过 <code>obj.name</code> 就可以取出课程名了。</p>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"φbt\"><div class=\"φbv\"><table><thead>\n<tr>\n<th style=\"text-align:center\">字段名</th>\n<th style=\"text-align:left\">类型</th>\n<th style=\"text-align:center\">是否必需</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">sno</td>\n<td style=\"text-align:left\">String</td>\n<td style=\"text-align:center\">是</td>\n<td style=\"text-align:left\">个人学号</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">pwd</td>\n<td style=\"text-align:left\">String</td>\n<td style=\"text-align:center\">是</td>\n<td style=\"text-align:left\">教务处密码</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">item</td>\n<td style=\"text-align:left\">String</td>\n<td style=\"text-align:center\">是</td>\n<td style=\"text-align:left\">查询学期，例：“2018-2019-2”</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">week</td>\n<td style=\"text-align:left\">Number</td>\n<td style=\"text-align:center\">是</td>\n<td style=\"text-align:left\">查询周次，例：1</td>\n</tr>\n</tbody>\n</table></div></div><p>  看完上面接口是不是还一脸懵逼，没关系，我们现在就开始学习网络请求，在网络请求中使用它，大家就会慢慢理解了。<br>\n  网络请求微信提供给的接口是 <code>wx.request</code>，在使用它之前，我们必须要上微信小程序后台设置：</p>\n<ul>\n<li>登录微信小程序后台：<a href=\"https://mp.weixin.qq.com\" target=\"_blank\">https://mp.weixin.qq.com</a></li>\n<li>点左侧 <code>开发</code> , 进入后点 <code>开发设置</code> , 找到下面服务器域名</li>\n<li>配置 <code>request合法域名</code> 为：<a href=\"https://server-1.isdz.cn\">https://server-1.isdz.cn</a></li>\n<li>完成后回到开发工具</li>\n<li>点击右上角 <code>详情</code>，找到下面点 <code>域名信息</code>查看是否配置成功</li>\n</ul>\n<p>我先将程序写出来，大家先自己理解理解：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js</span></span><br><span class=\"line\">Page(&#123;</span><br><span class=\"line\">  data: &#123;</span><br><span class=\"line\">    kcb: []</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">//生命周期函数：当页面加载的时候执行</span></span><br><span class=\"line\">  onLoad: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)　</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.refreshKCB();</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">//请求课程表</span></span><br><span class=\"line\">  refreshKCB: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> that = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">    wx.request(&#123;</span><br><span class=\"line\">      url: <span class=\"string\">&#x27;https://server-1.isdz.cn/api/kcb.dev.php&#x27;</span>,</span><br><span class=\"line\">      method: <span class=\"string\">&#x27;POST&#x27;</span>,</span><br><span class=\"line\">      data: &#123;</span><br><span class=\"line\">        sno: <span class=\"string\">&#x27;你的学号&#x27;</span>,</span><br><span class=\"line\">        pwd: <span class=\"string\">&#x27;你的教务处密码&#x27;</span>,</span><br><span class=\"line\">        item: <span class=\"string\">&#x27;2018-2019-1&#x27;</span>,</span><br><span class=\"line\">        week: <span class=\"number\">1</span></span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      header: &#123; <span class=\"string\">&quot;Content-Type&quot;</span>: <span class=\"string\">&quot;application/x-www-form-urlencoded&quot;</span> &#125;,</span><br><span class=\"line\">      success:  <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(e);<span class=\"comment\">//查看控制台关于e的格式</span></span><br><span class=\"line\">        that.setData(&#123;</span><br><span class=\"line\">          kcb: e.data</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      fail: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        wx.showToast(&#123;<span class=\"attr\">title</span>: <span class=\"string\">&#x27;网络开小差了&#x27;</span>,&#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>  这段代码是很简单一个网络请求，最后将返回数据通过setData()设置本地的kcb数组，与此同时，页面就随数据的变更而重新渲染了。</p>\n<ul>\n<li>先看总体结构上，我是将课程表请求封装在一个方法里，在页面的启动时，调用该方法。这样写的好处是，方便随时可以复用该请求。因为以后触发课程表请求还有很多方式，比如下拉刷新、周次选择等。本次触发的方式就是页面加载时触发请求。</li>\n<li>再看看请求，前面给出的接口，可能不明白，结合官网关于wx.request的文档（简介里有链接），我们需要给wx.request设置请求地址url，请求方式设置成POST，设置请求的数据data，然后设置的请求的打包类型，这个是我提供的接口需要这样的格式。</li>\n<li>最后有一个请求成功的回调函数success，其中的传入参数e就是请求返回的数据。这个e是被微信小程序底层重新打包过的，我们通过<code>e.data</code>可获取到接口返回的数据。</li>\n</ul>\n<p>效果：<br>\n<img src=\"../images//20190730112633.jpg\" alt=\"image\"></p>\n<h2 id=\"五、可选周次查询\">五、可选周次查询<a title=\"#五、可选周次查询\" href=\"#五、可选周次查询\"></a></h2>\n<p>  前面请求查询传输的数据都是写死的，比如week传输的1，查询的第一周的课程信息。我们需要从外面传入变量，动态改变这些值，实现页面可交互，用户可选择。这里介绍一个组件<a href=\"https://developers.weixin.qq.com/miniprogram/dev/component/picker.html\" target=\"_blank\">picker</a>：</p>\n<p>  这是一个比较复杂的组件，需要配合js进行使用。</p>\n<ul>\n<li>首先查看官方文档，发现内容介绍很多，这说明这个组件功能很强大；</li>\n<li>我们将使用普通选择器：mode = selector，也就是mode的默认值，可以不设置；</li>\n<li>我们将使用其中range、value和bindchange。<br>\n<code>range</code>：设置可选的全部数据<br>\n<code>value</code>：控制和接收选中数据的下标<br>\n<code>bindchange</code>：选中数据的改变触发事件<br>\n<img src=\"../images/20190731150340.jpg\" alt=\"image\"></li>\n<li>在课程表前面加一段代码：</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">    &lt;picker</span><br><span class=\"line\">        range=&quot;&#123;&#123;arrayZC&#125;&#125;&quot;</span><br><span class=\"line\">        value=&quot;&#123;&#123;indexZC&#125;&#125;&quot;</span><br><span class=\"line\">        bindchange=&#x27;zcChange&#x27; &gt;</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">view</span>&gt;</span>第 &#123;&#123;arrayZC[indexZC]&#125;&#125; 周<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">picker</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>在js中加入两个数据：</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data: &#123;</span><br><span class=\"line\">    kcb: [],</span><br><span class=\"line\">    indexZC: <span class=\"number\">0</span>,</span><br><span class=\"line\">    arrayZC: [</span><br><span class=\"line\">      <span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">16</span>,<span class=\"number\">17</span>,<span class=\"number\">18</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<ul>\n<li>在js中加入一个事件：</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//周次选择</span></span><br><span class=\"line\">zcChange: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.setData(&#123; <span class=\"attr\">indexZC</span>: e.detail.value &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>现在才算是将组件picker实现完毕。这几步缺一不可。现在可以进行周次的选择了，但是选择了周次并不会使下方课程表更新。</li>\n<li>想一想，我们可以在zzChange事件中获取当前选中的周次，那么，我们可以在这个事件里给<code>refreshKCB</code>事件传入一个周次数据，让其请求指定周的课程数据。如何做呢？传参！</li>\n<li>我们需要先将<code>refreshKCB</code>进行改造一下：</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//请求课程表</span></span><br><span class=\"line\">  refreshKCB: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">week</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"comment\">//省略一大段代码</span></span><br><span class=\"line\">      <span class=\"comment\">//.....</span></span><br><span class=\"line\">      method: <span class=\"string\">&#x27;POST&#x27;</span>,</span><br><span class=\"line\">      data: &#123;</span><br><span class=\"line\">        sno: <span class=\"string\">&#x27;你的学号&#x27;</span>,</span><br><span class=\"line\">        pwd: <span class=\"string\">&#x27;你的密码&#x27;</span>,</span><br><span class=\"line\">        item: <span class=\"string\">&#x27;2018-2019-1&#x27;</span>,</span><br><span class=\"line\">        week: week</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"comment\">//.....</span></span><br><span class=\"line\">      <span class=\"comment\">//省略一大段代码</span></span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n<p>其中我们传入一个参数周次，week字段传输的值是我们的传入的参数。可能大家现在有点疑惑，<code>week: week</code>是什么鬼？其实，冒号前面的week并不是变量，后面的week才是我们传入的参数。这样虽然名是一样，但底层处理时它能分辨的，加入我们传入的周次是<code>2</code>，那么最后解析成应该是<code>week: 2</code>。</p>\n<ul>\n<li>然后再在zcChange事件末尾调用请求课程表：</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//周次选择</span></span><br><span class=\"line\">zcChange: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">e</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">this</span>.setData(&#123; <span class=\"attr\">indexZC</span>: e.detail.value &#125;)</span><br><span class=\"line\">  <span class=\"built_in\">this</span>.refreshKCB(<span class=\"built_in\">this</span>.data.arrayZC[<span class=\"built_in\">this</span>.data.indexZC]);</span><br><span class=\"line\">  <span class=\"comment\">//还可以写成：</span></span><br><span class=\"line\">  <span class=\"comment\">//this.refreshKCB( e.detail.value + 1 );</span></span><br><span class=\"line\">  <span class=\"comment\">//解释：利用下标计算周次</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<ul>\n<li>最后还要改一下onLoad中的refreshKCB，先前写的事件，没有传值是会报错的。</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">onLoad: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)　</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.refreshKCB(<span class=\"built_in\">this</span>.data.arrayZC[<span class=\"built_in\">this</span>.data.indexZC]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>现在可以点击选择周次刷新课程表了！<br>\n<img src=\"../images/20190731154635.jpg\" alt=\"image\"></li>\n<li>完结撒花！</li>\n</ul>\n<h2 id=\"六、课程表完善\">六、课程表完善<a title=\"#六、课程表完善\" href=\"#六、课程表完善\"></a></h2>\n<p>  未完，待续</p>\n<h2 id=\"七、思维发散\">七、思维发散<a title=\"#七、思维发散\" href=\"#七、思维发散\"></a></h2>\n","prev":{"title":"JavaScript-axios","link":"Learning/3802578f2aa7"},"next":{"title":"Vue学习-组件","link":"Learning/ba1793c0983f"},"plink":"https://www.zzboy.cn//course-wechat-3/","toc":[{"id":"教程（三）-个人课程表实现","title":"教程（三）-个人课程表实现","index":"1","children":[{"id":"一、本节简介","title":"一、本节简介","index":"1.1"},{"id":"二、先画课程表","title":"二、先画课程表","index":"1.2","children":[{"id":"2.1-先实现课程表布局","title":"2.1 先实现课程表布局","index":"1.2.1"},{"id":"2.2-思考？列表渲染","title":"2.2 思考？列表渲染","index":"1.2.2"},{"id":"2.3-列表渲染实现布局","title":"2.3 列表渲染实现布局","index":"1.2.3"}]},{"id":"三、思考答案","title":"三、思考答案","index":"1.3"},{"id":"四、网络请求","title":"四、网络请求","index":"1.4"},{"id":"五、可选周次查询","title":"五、可选周次查询","index":"1.5"},{"id":"六、课程表完善","title":"六、课程表完善","index":"1.6"},{"id":"七、思维发散","title":"七、思维发散","index":"1.7"}]}],"reward":true,"copyright":{"author":"Patrick Jun","link":"<a href=\"https://www.zzboy.cn//course-wechat-3/\" title=\"微信小程序快速上手教程-3\">https://www.zzboy.cn//course-wechat-3/</a>","license":"自由转载-非商用-禁止演绎-保持署名 (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"July 29, 2019"}}