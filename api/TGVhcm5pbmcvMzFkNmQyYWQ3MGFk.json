{"title":"微信小程序-页面跳转传值","date":"2020-04-07T07:18:28.000Z","date_formatted":{"ll":"Apr 7, 2020","L":"04/07/2020","MM-DD":"04-07"},"link":"Learning/31d6d2ad70ad","tags":["微信小程序"],"categories":["Learning"],"updated":"2021-02-27T13:50:20.060Z","content":"<h2 id=\"简单传值\">简单传值<a title=\"#简单传值\" href=\"#简单传值\"></a></h2>\n<p>在微信小程序里，需要多个页面来完成业务逻辑时，通常用得最多的是<code>wx.navigateTo</code>进行跳转页面，该API跳转后，在左上角自然有个返回图标。</p>\n<ul>\n<li>传递参数（父页）</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//跳转到用户编辑页面</span></span><br><span class=\"line\">goToEdit: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> rid = <span class=\"built_in\">this</span>.data.user.rid;</span><br><span class=\"line\">    wx.navigateTo(&#123;</span><br><span class=\"line\">        url: <span class=\"string\">&#x27;edit/edit?rid=&#x27;</span>+rid</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>接收参数（子页）</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 生命周期函数--监听页面加载</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">onLoad: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">options</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// console.log(options)</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> rid = options.rid</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"复杂传值（对象传递）\">复杂传值（对象传递）<a title=\"#复杂传值（对象传递）\" href=\"#复杂传值（对象传递）\"></a></h2>\n<p>我原来是2018年10月份接触小程序的，那时只有通过url传参的方式，较大点的就存localStroage</p>\n<p>现在做毕业设计，发现有新的方法了，类似于Vue的emit方式</p>\n<h3 id=\"父传子\">父传子<a title=\"#父传子\" href=\"#父传子\"></a></h3>\n<ul>\n<li>传递参数（父页）</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//跳转到用户编辑页面</span></span><br><span class=\"line\">goToEdit: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> user = <span class=\"built_in\">this</span>.data.user;</span><br><span class=\"line\">    wx.navigateTo(&#123;</span><br><span class=\"line\">        url: <span class=\"string\">&#x27;edit/edit&#x27;</span>,</span><br><span class=\"line\">        success: <span class=\"function\">(<span class=\"params\">res</span>)=&gt;</span>&#123;</span><br><span class=\"line\">            res.eventChannel.emit(<span class=\"string\">&#x27;getDataFromUserPage&#x27;</span>, user)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>接收参数（子页）</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 生命周期函数--监听页面加载</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">onLoad: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">options</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.eventChannel = <span class=\"built_in\">this</span>.getOpenerEventChannel(); <span class=\"comment\">//将eventChannel绑定到this</span></span><br><span class=\"line\">    <span class=\"comment\">//监听从上个页面传来的数据</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.eventChannel.on(<span class=\"string\">&#x27;getDataFromUserPage&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;父页面传来的&#x27;</span>, data); <span class=\"comment\">//这里data就是父页传来的user对象</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"子传父\">子传父<a title=\"#子传父\" href=\"#子传父\"></a></h3>\n<ul>\n<li>传递参数（子页）</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//保存</span></span><br><span class=\"line\">saveUser: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//本处省略其他操作（网络请求更新用户数据等操作），直接进行放传参代码</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> newUser = <span class=\"built_in\">this</span>.data.user;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.eventChannel.emit(<span class=\"string\">&#x27;whenUpdated&#x27;</span>, newUser);</span><br><span class=\"line\">    wx.navigateBack();<span class=\"comment\">//返回父页面，默认返回1层</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>接收参数（父页）</p>\n<p>还是在<code>wx.navigateTo</code>里，添加events</p>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//跳转到用户编辑页面</span></span><br><span class=\"line\">goToEdit: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> user = <span class=\"built_in\">this</span>.data.user;</span><br><span class=\"line\">    wx.navigateTo(&#123;</span><br><span class=\"line\">        url: <span class=\"string\">&#x27;edit/edit&#x27;</span>,</span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\">        events: &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取从子页面传送到当前页面的数据</span></span><br><span class=\"line\">            whenUpdated: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;子页面传来的newUser&#x27;</span>,data)</span><br><span class=\"line\">                <span class=\"built_in\">this</span>.setData(&#123; <span class=\"attr\">user</span>: data &#125;)</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\">        success: <span class=\"function\">(<span class=\"params\">res</span>)=&gt;</span>&#123;</span><br><span class=\"line\">            res.eventChannel.emit(<span class=\"string\">&#x27;getDataFromUserPage&#x27;</span>, user)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","prev":{"title":"YApi平台以及pm2管理","link":"Learning/f360ef90efef"},"next":{"title":"Laravel常用命令","link":"Learning/05e70c5ba457"},"plink":"https://www.zzboy.cn/Learning/31d6d2ad70ad/","toc":[{"id":"简单传值","title":"简单传值","index":"1"},{"id":"复杂传值（对象传递）","title":"复杂传值（对象传递）","index":"2","children":[{"id":"父传子","title":"父传子","index":"2.1"},{"id":"子传父","title":"子传父","index":"2.2"}]}],"reward":true,"copyright":{"author":"Patrick Jun","link":"<a href=\"https://www.zzboy.cn/Learning/31d6d2ad70ad/\" title=\"微信小程序-页面跳转传值\">https://www.zzboy.cn/Learning/31d6d2ad70ad/</a>","license":"自由转载-非商用-禁止演绎-保持署名 (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"April 7, 2020"}}