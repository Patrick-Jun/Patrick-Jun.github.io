{"title":"留言板设计-PHP+MySQL入门程序","date":"2018-04-23T03:15:47.000Z","date_formatted":{"ll":"Apr 23, 2018","L":"04/23/2018","MM-DD":"04-23"},"link":"Learning/3c427628ca1d","comments":true,"tags":["PHP","留言板"],"categories":["Learning"],"updated":"2021-02-27T13:47:51.120Z","content":"<p><img src=\"http://blog.wujun.sc.cn/wp-content/uploads/2018/04/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20180423104334.png\" alt=\"\" class=\"φbs\"></p>\n<h1 id=\"程序结构图\">程序结构图<a title=\"#程序结构图\" href=\"#程序结构图\"></a></h1>\n<p><img src=\"http://blog.wujun.sc.cn/wp-content/uploads/2018/04/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20180423104519.png\" alt=\"\" class=\"φbs\"></p>\n<h1 id=\"前端设计\">前端设计<a title=\"#前端设计\" href=\"#前端设计\"></a></h1>\n<h2 id=\"留言界面\">留言界面<a title=\"#留言界面\" href=\"#留言界面\"></a></h2>\n<h3 id=\"框架结构图\">框架结构图<a title=\"#框架结构图\" href=\"#框架结构图\"></a></h3>\n<p><img src=\"http://blog.wujun.sc.cn/wp-content/uploads/2018/04/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20180423104612.png\" alt=\"\" class=\"φbs\"></p>\n<h3 id=\"代码：index.html\">代码：index.html<a title=\"#代码：index.html\" href=\"#代码：index.html\"></a></h3>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Leave a message to Patrick Jun<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">style</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/css&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t     .message&#123;</span><br><span class=\"line\"><span class=\"css\">\t\t         <span class=\"attribute\">margin-top</span>:<span class=\"number\">0px</span>;</span></span><br><span class=\"line\">\t\t     &#125;</span><br><span class=\"line\"><span class=\"css\">\t\t     <span class=\"selector-tag\">h1</span>&#123;</span></span><br><span class=\"line\"><span class=\"css\">\t\t         <span class=\"attribute\">margin-top</span>:<span class=\"number\">100px</span>;</span></span><br><span class=\"line\">\t\t     &#125;</span><br><span class=\"line\">\t\t     #message&#123;</span><br><span class=\"line\"><span class=\"css\">\t\t     \t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span></span><br><span class=\"line\"><span class=\"css\">\t\t     \t<span class=\"attribute\">font-size</span>: <span class=\"number\">24px</span>;</span></span><br><span class=\"line\">\t\t     &#125;</span><br><span class=\"line\">\t\t     #author,#title&#123;</span><br><span class=\"line\"><span class=\"css\">\t\t     \t<span class=\"attribute\">font-size</span>: <span class=\"number\">24px</span>;</span></span><br><span class=\"line\">\t\t     &#125;</span><br><span class=\"line\">    \t<span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">\t\t <span class=\"tag\">&lt;<span class=\"name\">h1</span> <span class=\"attr\">align</span>=<span class=\"string\">&quot;center&quot;</span>&gt;</span>Leave a message to Patrick Jun<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">\t\t   <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;message&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t       <span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;addform&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;addform&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;post&quot;</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;insert.php&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t           <span class=\"tag\">&lt;<span class=\"name\">table</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">align</span>=<span class=\"string\">&quot;center&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t            <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">\t\t                <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>What?<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">\t\t                <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">textarea</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;message&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;message&quot;</span> <span class=\"attr\">cols</span>=<span class=\"string\">&quot;30&quot;</span> <span class=\"attr\">role</span>=<span class=\"string\">&quot;15&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">textarea</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">\t\t            <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">\t\t            <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">\t\t                <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>Name<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">\t\t                <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;author&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;author&quot;</span>/&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">\t\t            <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">\t\t            <span class=\"tag\">&lt;<span class=\"name\">tr</span> <span class=\"attr\">align</span>=<span class=\"string\">&quot;center&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t                <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">colspan</span>=<span class=\"string\">&quot;2&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;sumbit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;Sumbit&quot;</span>/&gt;</span></span><br><span class=\"line\">\t\t                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;reset&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;reset&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;Reset&quot;</span>/&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">\t\t            <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">\t\t           <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">\t\t       <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">\t\t   <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"效果图\">效果图<a title=\"#效果图\" href=\"#效果图\"></a></h3>\n<p><img src=\"http://blog.wujun.sc.cn/wp-content/uploads/2018/04/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20180423104633.png\" alt=\"\" class=\"φbs\"></p>\n<h2 id=\"留言展示界面\">留言展示界面<a title=\"#留言展示界面\" href=\"#留言展示界面\"></a></h2>\n<h3 id=\"框架结构图-1\">框架结构图<a title=\"#框架结构图-1\" href=\"#框架结构图-1\"></a></h3>\n<p><img src=\"http://blog.wujun.sc.cn/wp-content/uploads/2018/04/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20180423104650.png\" alt=\"\" class=\"φbs\"></p>\n<h3 id=\"代码：show.php\">代码：show.php<a title=\"#代码：show.php\" href=\"#代码：show.php\"></a></h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">header(<span class=\"string\">&quot;Content-Type: text/html; charset=UTF-8&quot;</span>);</span><br><span class=\"line\"><span class=\"variable\">$localhost</span>=<span class=\"string\">&#x27;localhost&#x27;</span>;</span><br><span class=\"line\"><span class=\"variable\">$user</span>=<span class=\"string\">&#x27;youruser&#x27;</span>;<span class=\"comment\">//你的数据库用户名</span></span><br><span class=\"line\"><span class=\"variable\">$password</span>=<span class=\"string\">&#x27;yourpassword&#x27;</span>;<span class=\"comment\">//你的数据库密码</span></span><br><span class=\"line\"><span class=\"variable\">$database</span>=<span class=\"string\">&#x27;test&#x27;</span>;<span class=\"comment\">//数据库名</span></span><br><span class=\"line\"><span class=\"variable\">$tablename</span>=<span class=\"string\">&#x27;messageboard&#x27;</span>;<span class=\"comment\">//表名</span></span><br><span class=\"line\"><span class=\"variable\">$con</span> = mysqli_connect(<span class=\"variable\">$localhost</span>, <span class=\"variable\">$user</span>, <span class=\"variable\">$password</span>);<span class=\"comment\">//数据库连接</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"variable\">$con</span> )</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;连接失败:&quot;</span> . mysqli_error(<span class=\"variable\">$con</span>)) ;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span> <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;连接成功...&lt;br /&gt;&#x27;</span>;</span><br><span class=\"line\">mysqli_query(<span class=\"variable\">$con</span>,<span class=\"string\">&quot;set names utf8&quot;</span>);</span><br><span class=\"line\">mysqli\\_select\\_db(<span class=\"variable\">$con</span>,<span class=\"variable\">$database</span>);<span class=\"comment\">//选择数据库</span></span><br><span class=\"line\"><span class=\"variable\">$sql</span>=<span class=\"string\">&quot;select id,author,message,time from <span class=\"subst\">$tablename</span>&quot;</span>;<span class=\"comment\">//从表中选择数据</span></span><br><span class=\"line\"><span class=\"variable\">$retval</span>=mysqli_query(<span class=\"variable\">$con</span>,<span class=\"variable\">$sql</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"variable\">$retval</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">die</span>(<span class=\"string\">&#x27;读取数据失败：&#x27;</span> . mysqli_error(<span class=\"variable\">$con</span>));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\">&lt;HTML&gt;</span><br><span class=\"line\">&lt;Head&gt;</span><br><span class=\"line\">    &lt;meta  http-equiv=<span class=\"string\">&quot;CONTENT-TYPE&quot;</span> content=<span class=\"string\">&quot;text/html&quot;</span>  ; charset=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span><br><span class=\"line\">\t\t&lt;title&gt;Leave a message to Patrick Jun&lt;/title&gt;</span><br><span class=\"line\">        &lt;style type=<span class=\"string\">&quot;text/css&quot;</span>&gt;</span><br><span class=\"line\">\t\t     .message&#123;</span><br><span class=\"line\">\t\t         margin-top:<span class=\"number\">0</span>px;</span><br><span class=\"line\">\t\t     &#125;</span><br><span class=\"line\">\t\t     h1&#123;</span><br><span class=\"line\">\t\t         margin-top:<span class=\"number\">100</span>px;</span><br><span class=\"line\">\t\t     &#125;</span><br><span class=\"line\">\t\t     <span class=\"comment\">#message&#123;</span></span><br><span class=\"line\">\t\t     \theight: <span class=\"number\">100</span>px;</span><br><span class=\"line\">\t\t     \tfont-size: <span class=\"number\">24</span>px;</span><br><span class=\"line\">\t\t     &#125;</span><br><span class=\"line\">\t\t     <span class=\"comment\">#author,#title&#123;</span></span><br><span class=\"line\">\t\t     \tfont-size: <span class=\"number\">24</span>px;</span><br><span class=\"line\">\t\t     &#125;</span><br><span class=\"line\">\t\t.tdcenter&#123;</span><br><span class=\"line\">\t\t\ttext-align:center;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">    \t&lt;/style&gt;</span><br><span class=\"line\">&lt;/Head&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">\t&lt;h1 align=<span class=\"string\">&quot;center&quot;</span>&gt;Leave a message to Patrick Jun&lt;/h1&gt;</span><br><span class=\"line\">\t\t   &lt;div class=&quot;message&quot;&gt;</span><br><span class=\"line\">\t\t       &lt;form name=<span class=\"string\">&quot;addform&quot;</span> id=<span class=\"string\">&quot;addform&quot;</span> method=<span class=\"string\">&quot;post&quot;</span> action=<span class=\"string\">&quot;insert.php&quot;</span>&gt;</span><br><span class=\"line\">\t\t           &lt;table type=<span class=\"string\">&quot;text&quot;</span> align=<span class=\"string\">&quot;center&quot;</span>&gt;</span><br><span class=\"line\">\t\t               &lt;input type=<span class=\"string\">&quot;hidden&quot;</span> id=<span class=\"string\">&quot;id&quot;</span> name=<span class=\"string\">&quot;id&quot;</span> /&gt;</span><br><span class=\"line\">\t\t            &lt;tr&gt;</span><br><span class=\"line\">\t\t                &lt;td&gt;What?&lt;/td&gt;</span><br><span class=\"line\">\t\t                &lt;td&gt;&lt;textarea name=<span class=\"string\">&quot;message&quot;</span> id=<span class=\"string\">&quot;message&quot;</span> cols=<span class=\"string\">&quot;30&quot;</span> role=<span class=\"string\">&quot;15&quot;</span>&gt;&lt;/textarea&gt;&lt;/td&gt;</span><br><span class=\"line\">\t\t            &lt;/tr&gt;</span><br><span class=\"line\">\t\t            &lt;tr&gt;</span><br><span class=\"line\">\t\t                &lt;td&gt;Name&lt;/td&gt;</span><br><span class=\"line\">\t\t                &lt;td&gt;&lt;input type=<span class=\"string\">&quot;text&quot;</span> name=<span class=\"string\">&quot;author&quot;</span> id=<span class=\"string\">&quot;author&quot;</span>/&gt; &lt;/td&gt;</span><br><span class=\"line\">\t\t            &lt;/tr&gt;</span><br><span class=\"line\">\t\t            &lt;tr align=<span class=\"string\">&quot;center&quot;</span>&gt;</span><br><span class=\"line\">\t\t                &lt;td colspan=<span class=\"string\">&quot;2&quot;</span>&gt;&lt;input type=<span class=\"string\">&quot;submit&quot;</span> name=<span class=\"string\">&quot;sumbit&quot;</span> value=<span class=\"string\">&quot;Sumbit&quot;</span>/&gt;</span><br><span class=\"line\">\t\t                \t&lt;input type=<span class=\"string\">&quot;reset&quot;</span> name=<span class=\"string\">&quot;reset&quot;</span> value=<span class=\"string\">&quot;Reset&quot;</span>/&gt;&lt;/td&gt;</span><br><span class=\"line\">\t\t            &lt;/tr&gt;</span><br><span class=\"line\">\t\t           &lt;/table&gt;</span><br><span class=\"line\">\t\t       &lt;/form&gt;</span><br><span class=\"line\">\t\t   &lt;/div&gt;</span><br><span class=\"line\">\t\t  &lt;hr size=<span class=\"string\">&quot;1&quot;</span> style=<span class=\"string\">&quot;border: dotted;&quot;</span>&gt;</span><br><span class=\"line\">\t&lt;div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>(<span class=\"variable\">$retval</span>))&#123;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;还没有留言&quot;</span>;</span><br><span class=\"line\">&#125;<span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">&lt;h2&gt;Message Record:&lt;h2&gt;</span><br><span class=\"line\">\t&lt;center&gt; &lt;table border=<span class=\"string\">&quot;1&quot;</span> cellspacing=<span class=\"string\">&quot;0&quot;</span> cellpadding=<span class=\"string\">&quot;0&quot;</span>&gt;</span><br><span class=\"line\">\t&lt;tr&gt;&lt;td width=&quot;30&quot; class=&quot;tdcenter&quot;&gt;&lt;b&gt;ID&lt;/b&gt;&lt;/td&gt;</span><br><span class=\"line\">\t&lt;td width=&quot;150&quot; class=&quot;tdcenter&quot;&gt;&lt;b&gt;Name&lt;/b&gt;&lt;/td&gt;</span><br><span class=\"line\">\t&lt;td width=&quot;70%&quot; class=&quot;tdcenter&quot;&gt;&lt;b&gt;Message&lt;/b&gt;&lt;/td&gt;</span><br><span class=\"line\">\t&lt;td class=&quot;tdcenter&quot;&gt;&lt;b&gt;Time&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">&lt;?php</span> <span class=\"keyword\">while</span>(<span class=\"variable\">$row</span> = mysqli\\_fetch\\_assoc(<span class=\"variable\">$retval</span>))&#123; <span class=\"meta\">?&gt;</span><span class=\"comment\">//遍历输出数据</span></span><br><span class=\"line\">\t\t&lt;tr&gt;&lt;td class=&#x27;tdcenter&#x27;&gt;&lt;?php echo &quot;$row\\[&#x27;id&#x27;\\]&quot;;?&gt;&lt;/td&gt;</span><br><span class=\"line\">\t\t&lt;td class=&#x27;tdcenter&#x27;&gt;&lt;?php echo &quot;$row\\[&#x27;author&#x27;\\]&quot;;?&gt;&lt;/td&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;<span class=\"meta\">&lt;?php</span> <span class=\"keyword\">echo</span> <span class=\"string\">&quot;<span class=\"subst\">$row</span>\\[&#x27;message&#x27;\\]&quot;</span>;<span class=\"meta\">?&gt;</span>&lt;/td&gt;</span><br><span class=\"line\">\t\t&lt;td class=&#x27;tdcenter&#x27;&gt;&lt;?php echo &quot;$row\\[&#x27;time&#x27;\\]&quot;;?&gt;&lt;/td&gt;</span><br><span class=\"line\">\t\t&lt;/tr&gt;</span><br><span class=\"line\">        <span class=\"meta\">&lt;?php</span> &#125; <span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t&lt;/table&gt;&lt;/center&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">&lt;?php</span> mysqli_close(<span class=\"variable\">$con</span>);<span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;/Body&gt;</span><br><span class=\"line\">&lt;/HTML&gt;</span><br></pre></td></tr></table></figure>\n<h1 id=\"后端设计设计\">后端设计设计<a title=\"#后端设计设计\" href=\"#后端设计设计\"></a></h1>\n<h2 id=\"数据写入数据库\">数据写入数据库<a title=\"#数据写入数据库\" href=\"#数据写入数据库\"></a></h2>\n<h3 id=\"代码：insert.php\">代码：insert.php<a title=\"#代码：insert.php\" href=\"#代码：insert.php\"></a></h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\">header(<span class=\"string\">&quot;CONTENT-TYPE:text/html;charset=UTF-8&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">check</span>\\<span class=\"title\">_table</span>\\<span class=\"title\">_is</span>\\<span class=\"title\">_exist</span>(<span class=\"params\"><span class=\"variable\">$con</span>,<span class=\"variable\">$database</span>,<span class=\"variable\">$find</span>\\_table</span>)//判断是否存在数据库和表</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(mysqli\\_select\\_db(<span class=\"variable\">$con</span>,<span class=\"variable\">$database</span>))&#123;</span><br><span class=\"line\">    \t<span class=\"variable\">$sql</span> = <span class=\"string\">&quot;show tables&quot;</span>; <span class=\"comment\">// to show databases </span></span><br><span class=\"line\">\t    <span class=\"variable\">$row</span> = mysqli_query(<span class=\"variable\">$con</span>,<span class=\"variable\">$sql</span>);</span><br><span class=\"line\">\t    <span class=\"keyword\">while</span> (<span class=\"variable\">$result</span> = mysqli\\_fetch\\_array(<span class=\"variable\">$row</span>,MYSQLI_NUM ))</span><br><span class=\"line\">\t    &#123;</span><br><span class=\"line\">\t        <span class=\"keyword\">for</span>( <span class=\"variable\">$i</span> = <span class=\"number\">0</span> ; <span class=\"variable\">$i</span> &lt; count(<span class=\"variable\">$result</span>); <span class=\"variable\">$i</span>++)&#123;</span><br><span class=\"line\">\t            <span class=\"keyword\">if</span>( <span class=\"variable\">$find_table</span> ==  <span class=\"variable\">$result</span>\\[<span class=\"variable\">$i</span>\\]) &#123;</span><br><span class=\"line\">\t                <span class=\"comment\">// echo &quot;found &quot; . $find_table . &#x27;&lt;br /&gt;&#x27;;</span></span><br><span class=\"line\">\t                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;   </span><br><span class=\"line\">\t            &#125;</span><br><span class=\"line\">\t        &#125;</span><br><span class=\"line\">\t    &#125;</span><br><span class=\"line\">\t    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;\t</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">echo</span> <span class=\"string\">&quot;数据库不存在&quot;</span>;</span><br><span class=\"line\">    \t<span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$localhost</span>=<span class=\"string\">&#x27;localhost&#x27;</span>;</span><br><span class=\"line\"><span class=\"variable\">$user</span>=<span class=\"string\">&#x27;youruser&#x27;</span>;<span class=\"comment\">//你的数据库用户名</span></span><br><span class=\"line\"><span class=\"variable\">$password</span>=<span class=\"string\">&#x27;yourpassword&#x27;</span>;<span class=\"comment\">//你的数据库密码</span></span><br><span class=\"line\"><span class=\"variable\">$database</span>=<span class=\"string\">&#x27;test&#x27;</span>;<span class=\"comment\">//数据库名</span></span><br><span class=\"line\"><span class=\"variable\">$tablename</span>=<span class=\"string\">&#x27;messageboard&#x27;</span>;<span class=\"comment\">//表名</span></span><br><span class=\"line\"><span class=\"variable\">$con</span> = mysqli_connect(<span class=\"variable\">$localhost</span>, <span class=\"variable\">$user</span>, <span class=\"variable\">$password</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"variable\">$con</span> )</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;连接失败:&quot;</span> . mysqli_error(<span class=\"variable\">$con</span>)) ;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span> <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;连接成功...&lt;br /&gt;&#x27;</span>;</span><br><span class=\"line\">mysqli_query(<span class=\"variable\">$con</span>,<span class=\"string\">&quot;set names utf8&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$author</span>=<span class=\"variable\">$_POST</span>\\[<span class=\"string\">&quot;author&quot;</span>\\];<span class=\"comment\">//获取前端页面index.html传来的数据</span></span><br><span class=\"line\"><span class=\"variable\">$message</span>=<span class=\"variable\">$_POST</span>\\[<span class=\"string\">&quot;message&quot;</span>\\];</span><br><span class=\"line\"><span class=\"variable\">$time</span>=date(<span class=\"string\">&#x27;Y-m-d-h:m:s&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span>(!mysqli\\_select\\_db(<span class=\"variable\">$con</span>,<span class=\"variable\">$database</span>))&#123;<span class=\"comment\">//判断是否存在数据库，不存在就新创建一个数据库</span></span><br><span class=\"line\">\t<span class=\"variable\">$sql</span>=<span class=\"string\">&quot;CREATE DATABASE <span class=\"subst\">$database</span>&quot;</span>;</span><br><span class=\"line\">\tmysqli_query(<span class=\"variable\">$con</span>,<span class=\"variable\">$sql</span>);</span><br><span class=\"line\">\tmysqli\\_select\\_db(<span class=\"variable\">$con</span>,<span class=\"variable\">$database</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(!check\\_table\\_is_exist(<span class=\"variable\">$con</span>,<span class=\"variable\">$database</span>,<span class=\"variable\">$tablename</span>))&#123;<span class=\"comment\">//判断是否存在表，不存在就新创建一个表</span></span><br><span class=\"line\">\t<span class=\"variable\">$sql</span>=<span class=\"string\">&quot;CREATE TABLE <span class=\"subst\">$tablename</span>(</span></span><br><span class=\"line\"><span class=\"string\">\t\tid INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,</span></span><br><span class=\"line\"><span class=\"string\">\t\tauthor VARCHAR(30),</span></span><br><span class=\"line\"><span class=\"string\">\t\tmessage VARCHAR(20),</span></span><br><span class=\"line\"><span class=\"string\">\t\ttime TIMESTAMP</span></span><br><span class=\"line\"><span class=\"string\">\t)&quot;</span>;</span><br><span class=\"line\">\tmysqli_query(<span class=\"variable\">$con</span>,<span class=\"variable\">$sql</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"variable\">$sql</span>=<span class=\"string\">&quot;INSERT INTO <span class=\"subst\">$tablename</span>(author,message,time) VALUES(&#x27;<span class=\"subst\">$author</span>&#x27;,&#x27;<span class=\"subst\">$message</span>&#x27;,&#x27;<span class=\"subst\">$time</span>&#x27;)&quot;</span>;<span class=\"comment\">//向数据库中插入数据</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$result</span>=mysqli_query(<span class=\"variable\">$con</span>,<span class=\"variable\">$sql</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$result</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;script&gt;alert(&#x27;写入成功！&#x27;);window.location.href=&#x27;show.php&#x27;&lt;/script&gt;&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;script&gt;alert(&#x27;写入失败！&#x27;);window.location.href=&#x27;index.html&#x27;&lt;/script&gt;&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>初学时，自己写的留言系统，很多东西可能都不够完善，但对于新手理解PHP+MySQL的程序设计应该够了。如果有PHP大佬路过，请帮忙指出该程序的不足之处，谢谢！</strong></p>\n","prev":{"title":"php版本5.*升级7.0","link":"Learning/cd9209d16b74"},"next":{"title":"Java学习-值类型的变量和值及其运算","link":"Learning/111a1ef59c51"},"plink":"https://www.zzboy.cn/Learning/3c427628ca1d/","toc":[{"id":"程序结构图","title":"程序结构图","index":"1"},{"id":"前端设计","title":"前端设计","index":"2","children":[{"id":"留言界面","title":"留言界面","index":"2.1","children":[{"id":"框架结构图","title":"框架结构图","index":"2.1.1"},{"id":"代码：index.html","title":"代码：index.html","index":"2.1.2"},{"id":"效果图","title":"效果图","index":"2.1.3"}]},{"id":"留言展示界面","title":"留言展示界面","index":"2.2","children":[{"id":"框架结构图-1","title":"框架结构图","index":"2.2.1"},{"id":"代码：show.php","title":"代码：show.php","index":"2.2.2"}]}]},{"id":"后端设计设计","title":"后端设计设计","index":"3","children":[{"id":"数据写入数据库","title":"数据写入数据库","index":"3.1","children":[{"id":"代码：insert.php","title":"代码：insert.php","index":"3.1.1"}]}]}],"reward":true,"copyright":{"author":"Patrick Jun","link":"<a href=\"https://www.zzboy.cn/Learning/3c427628ca1d/\" title=\"留言板设计-PHP+MySQL入门程序\">https://www.zzboy.cn/Learning/3c427628ca1d/</a>","license":"自由转载-非商用-禁止演绎-保持署名 (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"April 23, 2018"}}